{% extends 'index.html' %}


{% block content %}
<div class="container flex-full">
    <div class="full-vh threats-side-component">
        <div class="header">
            <h2>Conversations</h2>
        </div>
        <div class="options">
            <div>
                <button class="button-gray-coral">New chat</button>
            </div>
            <div><span >Filter by text:</span>
                <input type="text" class="" />
            </div>
        </div>
        <div class="history">
            {% for conversation in conversations %}
            <button>{{conversation.title}}</button>
            {% endfor %}
        </div>
        <div class="footer">
            <span >User: {{user.username}}</span>
        </div>
    </div>
    <div class="playground-component">
        <div class="header">
            <h1 class="font-gradient">Chat</h1>
        </div>
        <div class="chat-input">
            <textarea class="h-full" type="text"></textarea>
            <button class="button-gray-coral">Submit</button>
        </div>
        <div class="chat-tools">
            <label for="agent">Agent:</label>
            <select name="agents" id="agents">
                {% for agent in agents %}
                <option value="{{ agent.id }}"{% if forloop.first %} selected{% endif %}>{{ agent.name }}</option>
                {% endfor %}
            </select>
            <label for="documents">Document:</label>
            <select name="documents" id="documents">
                {% for agent in documents %}
                <option value="{{ agent.id }}"{% if forloop.first %} selected{% endif %}>{{ agent.title }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="chat-messages">
         
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
<script>

const conversationId = 123; // Replace with the actual conversation ID
const url = `/conversation/${conversationId}/message`;

// Payload data
const payload = {
  question: "What is your question?",
  conversation_id: 3,
  document_id: 456, // Replace with the actual document ID
  agent_id: 789, // Replace with the actual agent ID
};

// Fetch request
fetch(url, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer YOUR_AUTH_TOKEN', // Replace with your actual authorization token
  },
  body: JSON.stringify(payload),
})
  .then(response => response.json())
  .then(data => {
    // Handle the response data
    console.log(data);
  })
  .catch(error => {
    // Handle any errors
    console.error(error);
  });




</script>
{% endblock %}